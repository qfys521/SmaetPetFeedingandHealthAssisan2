import { PostUserData } from '../model/PostUserData'
import { prompt } from '@kit.ArkUI'

@CustomDialog
export struct PostUserDataDialog {
  @State userName: string = ''
  @State email: string = ''
  @State phoneNumber: string = ''
  @State homeAddress: string = ''
  @State password: string = ''
  cancel: () => void = () => {
  }
  confirm: (data: PostUserData) => void = (data: PostUserData) => {
  }
  controller: CustomDialogController

  build() {
    Scroll() {
      Column({ space: 20 }) {
        Text('ğŸ‘¤ ç”¨æˆ·æ³¨å†Œ')
          .fontSize(24)
          .fontWeight(FontWeight.Bold)
          .margin({ top: 20 })

        // ç”¨æˆ·å
        Column() {
          Text('ç”¨æˆ·åï¼š').fontSize(16)
          TextInput({ placeholder: 'è¯·è¾“å…¥ç”¨æˆ·å' })
            .width('90%')
            .height(40)
            .backgroundColor('#f2f2f2')
            .borderRadius(8)
            .onChange((v) => this.userName = v)
        }

        // é‚®ç®±
        Column() {
          Text('ğŸ“§ é‚®ç®±åœ°å€ï¼š').fontSize(16)
          TextInput({ placeholder: 'è¯·è¾“å…¥é‚®ç®±åœ°å€' })
            .width('90%')
            .height(40)
            .type(InputType.Email)
            .backgroundColor('#f2f2f2')
            .borderRadius(8)
            .onChange((v) => this.email = v)
        }

        // ç”µè¯
        Column() {
          Text('ç”µè¯å·ç ï¼š').fontSize(16)
          TextInput({ placeholder: 'è¯·è¾“å…¥ç”µè¯å·ç ' })
            .width('90%')
            .height(40)
            .type(InputType.Number)
            .backgroundColor('#f2f2f2')
            .borderRadius(8)
            .onChange((v) => this.phoneNumber = v)
        }

        // åœ°å€
        Column() {
          Text('å®¶åº­åœ°å€ï¼š').fontSize(16)
          TextArea({ placeholder: 'è¯·è¾“å…¥å®¶åº­åœ°å€' })
            .width('90%')
            .height(100)
            .backgroundColor('#f2f2f2')
            .borderRadius(8)
            .onChange((v) => this.homeAddress = v)
        }

        // å¯†ç 
        Column() {
          Text('å¯†ç ï¼š').fontSize(16)
          TextInput({ placeholder: 'è¯·è¾“å…¥å¯†ç ' })
            .width('90%')
            .height(40)
            .type(InputType.Password)
            .backgroundColor('#f2f2f2')
            .borderRadius(8)
            .onChange((v) => this.password = v)
        }

        // æŒ‰é’®è¡Œ
        Row({ space: 20 }) {
          Button('å–æ¶ˆ')
            .width('40%')
            .height(45)
            .backgroundColor('#ccc')
            .fontColor('#000')
            .borderRadius(10)
            .onClick(() => {
              this.controller.close()
              if (this.cancel) {
                this.cancel()
              }
              this.userName = ''
              this.email = ''
              this.phoneNumber = ''
              this.homeAddress = ''
              this.password = ''
              prompt.showToast({ message: 'å·²å–æ¶ˆæ³¨å†Œ' })
            })

          Button('æ³¨å†Œ')
            .width('40%')
            .height(45)
            .backgroundColor('#007bff')
            .fontColor('#fff')
            .borderRadius(10)
            .onClick(() => {
              if (!this.userName || !this.email || !this.password) {
                prompt.showToast({ message: 'è¯·å¡«å†™å¿…å¡«é¡¹ï¼šç”¨æˆ·åã€é‚®ç®±ã€å¯†ç ' })
                return
              }

              const data = new PostUserData(
                this.userName,
                this.email,
                this.phoneNumber,
                this.homeAddress,
                this.password
              )
              prompt.showToast({ message: `æ³¨å†ŒæˆåŠŸï¼š${this.userName}` })
              this.controller.close()
              if (this.confirm) {
                this.confirm(data)
              }
            })
        }
        .justifyContent(FlexAlign.Center)
        .margin({ top: 30 })
      }
      .width('100%')
      .padding(20)
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#fff')
  }
}
